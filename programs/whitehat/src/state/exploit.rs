use anchor_lang::prelude::*;

use crate::constants::*;

#[account]
pub struct Exploit {
    pub protocol: Pubkey,
    pub program: Pubkey,
    pub mint: Option<Pubkey>,
    pub payout: Pubkey,
    pub reviewed: bool,
    pub dispute: bool,
    pub amount: u64,
    pub created_at: i64,
    pub bump: u8,
}

impl Exploit {
    pub const LEN: usize = DISCRIMINATOR_LENGTH
        + 8
        + PUBLIC_KEY_LENGTH * 3 // payout, protocol
        + 8
        + BOOL_LENGTH * 2 // reviewed, dispute
        + TIMESTAMP_LENGTH // created_at
        + BUMP_LENGTH // bump
        + 8; // seed
}
